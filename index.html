<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Login</title>
  <link rel="stylesheet" href="style.css">
  <script src="config.js"></script>
  <script defer>
    document.addEventListener("DOMContentLoaded", () => {
      const base = document.createElement('base');
      base.href = location.hostname === 'localhost' ? '/' : 'https://joshthinh.github.io/Elen-Signin/';
      document.head.appendChild(base);
  
      // Ensure config.js is loaded before accessing API_URL / API_URL_DEPLOYED
      if (typeof API_URL === 'undefined' || typeof API_URL_DEPLOYED === 'undefined') {
        console.error('API_URL or API_URL_DEPLOYED is not defined. Check config.js loading.');
        return;
      }
  
      window.ApiUrlLink = location.hostname === 'localhost' ? API_URL : API_URL_DEPLOYED;
  
      // Continue rest of logic here if needed
    });
  </script>
  <style>
    /* Responsive scaling variables */
    :root {
      --scale-phone: 0.8;
      --scale-tablet: 0.9;
      --scale-desktop: 1;
      --scale-tv: 1.1;
    }
    
    /* Global viewport control */
    * {
      box-sizing: border-box;
    }
    
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      overflow-x: hidden !important;
      max-width: 100vw !important;
      width: 100vw !important;
    }
    .login-container {
      background: white;
      padding: 40px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
      min-width: 300px;
    }
    h2 {
      margin-bottom: 30px;
      color: #333;
    }
    input {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    button {
      width: 100%;
      padding: 12px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    .signup-link {
      margin-top: 20px;
    }
    .signup-link a {
      color: #007bff;
      text-decoration: none;
    }
    .signup-link a:hover {
      text-decoration: underline;
    }
    
    /* iPhone and small phones (up to 428px) */
    @media screen and (max-width: 428px) {
      :root {
        --scale-phone: 0.75;
        --scale-tablet: 0.8;
        --scale-desktop: 0.85;
        --scale-tv: 0.9;
      }
      
      body {
        font-size: calc(14px * var(--scale-phone));
        padding: calc(10px * var(--scale-phone));
      }
      
      .login-container {
        padding: calc(20px * var(--scale-phone)) !important;
        margin: calc(10px * var(--scale-phone)) !important;
        max-width: calc(100vw - 20px) !important;
        width: calc(100vw - 40px) !important;
        min-width: calc(280px * var(--scale-phone)) !important;
        border-radius: calc(8px * var(--scale-phone)) !important;
        box-shadow: 0 calc(4px * var(--scale-phone)) calc(6px * var(--scale-phone)) rgba(0, 0, 0, 0.1) !important;
      }
      
      h2 {
        font-size: calc(1.5rem * var(--scale-phone));
        margin-bottom: calc(20px * var(--scale-phone));
      }
      
      input {
        padding: calc(10px * var(--scale-phone));
        margin: calc(6px * var(--scale-phone)) 0;
        border-radius: calc(4px * var(--scale-phone));
        font-size: calc(14px * var(--scale-phone));
      }
      
      button {
        padding: calc(10px * var(--scale-phone));
        border-radius: calc(4px * var(--scale-phone));
        font-size: calc(14px * var(--scale-phone));
        margin-top: calc(8px * var(--scale-phone));
      }
      
      .signup-link {
        margin-top: calc(15px * var(--scale-phone));
        font-size: calc(13px * var(--scale-phone));
      }
    }
    
    /* iPhone 16 Pro and larger phones (429px - 768px) */
    @media screen and (min-width: 429px) and (max-width: 768px) {
      :root {
        --scale-phone: 0.85;
        --scale-tablet: 0.9;
        --scale-desktop: 0.95;
        --scale-tv: 1;
      }
      
      body {
        font-size: calc(15px * var(--scale-phone));
        padding: calc(15px * var(--scale-phone));
      }
      
      .login-container {
        padding: calc(30px * var(--scale-phone));
        margin: calc(15px * var(--scale-phone));
        max-width: calc(100vw - 30px);
        width: calc(100vw - 60px);
        min-width: calc(320px * var(--scale-phone));
        border-radius: calc(8px * var(--scale-phone));
        box-shadow: 0 calc(4px * var(--scale-phone)) calc(6px * var(--scale-phone)) rgba(0, 0, 0, 0.1);
      }
      
      h2 {
        font-size: calc(1.8rem * var(--scale-phone));
        margin-bottom: calc(25px * var(--scale-phone));
      }
      
      input {
        padding: calc(12px * var(--scale-phone));
        margin: calc(8px * var(--scale-phone)) 0;
        border-radius: calc(4px * var(--scale-phone));
        font-size: calc(15px * var(--scale-phone));
      }
      
      button {
        padding: calc(12px * var(--scale-phone));
        border-radius: calc(4px * var(--scale-phone));
        font-size: calc(15px * var(--scale-phone));
        margin-top: calc(10px * var(--scale-phone));
      }
      
      .signup-link {
        margin-top: calc(18px * var(--scale-phone));
        font-size: calc(14px * var(--scale-phone));
      }
    }
    
    /* MacBook and laptop scaling (769px - 1439px) */
    @media screen and (min-width: 769px) and (max-width: 1439px) {
      :root {
        --scale-phone: 0.9;
        --scale-tablet: 0.95;
        --scale-desktop: 1;
        --scale-tv: 1.05;
      }
      
      body {
        font-size: calc(16px * var(--scale-desktop));
      }
      
      .login-container {
        padding: calc(40px * var(--scale-desktop));
        min-width: calc(300px * var(--scale-desktop));
        border-radius: calc(8px * var(--scale-desktop));
        box-shadow: 0 calc(4px * var(--scale-desktop)) calc(6px * var(--scale-desktop)) rgba(0, 0, 0, 0.1);
      }
      
      h2 {
        font-size: calc(2rem * var(--scale-desktop));
        margin-bottom: calc(30px * var(--scale-desktop));
      }
      
      input {
        padding: calc(12px * var(--scale-desktop));
        margin: calc(8px * var(--scale-desktop)) 0;
        border-radius: calc(4px * var(--scale-desktop));
        font-size: calc(16px * var(--scale-desktop));
      }
      
      button {
        padding: calc(12px * var(--scale-desktop));
        border-radius: calc(4px * var(--scale-desktop));
        font-size: calc(16px * var(--scale-desktop));
        margin-top: calc(12px * var(--scale-desktop));
      }
      
      .signup-link {
        margin-top: calc(20px * var(--scale-desktop));
        font-size: calc(15px * var(--scale-desktop));
      }
    }
    
    /* Desktop monitors (1440px and up) */
    @media screen and (min-width: 1440px) {
      :root {
        --scale-phone: 1;
        --scale-tablet: 1.05;
        --scale-desktop: 1.1;
        --scale-tv: 1.2;
      }
      
      body {
        font-size: calc(16px * var(--scale-desktop));
      }
      
      .login-container {
        padding: calc(50px * var(--scale-desktop));
        min-width: calc(350px * var(--scale-desktop));
        border-radius: calc(10px * var(--scale-desktop));
        box-shadow: 0 calc(6px * var(--scale-desktop)) calc(12px * var(--scale-desktop)) rgba(0, 0, 0, 0.15);
      }
      
      h2 {
        font-size: calc(2.2rem * var(--scale-desktop));
        margin-bottom: calc(35px * var(--scale-desktop));
      }
      
      input {
        padding: calc(15px * var(--scale-desktop));
        margin: calc(10px * var(--scale-desktop)) 0;
        border-radius: calc(6px * var(--scale-desktop));
        font-size: calc(16px * var(--scale-desktop));
      }
      
      button {
        padding: calc(15px * var(--scale-desktop));
        border-radius: calc(6px * var(--scale-desktop));
        font-size: calc(16px * var(--scale-desktop));
        margin-top: calc(15px * var(--scale-desktop));
      }
      
      .signup-link {
        margin-top: calc(25px * var(--scale-desktop));
        font-size: calc(16px * var(--scale-desktop));
      }
    }
  </style>
</head>
<body>
  <div class="login-container">
    <h2>Login</h2>
    <form id="loginForm">
      <input type="text" id="username" placeholder="Username" required>
      <input type="password" id="password" placeholder="Password" required>
      <button type="submit">Login</button>
    </form>
    <div class="signup-link">
      <a href="signup.html">Don't have an account? Sign up</a>
    </div>
  </div>
  <script>
    // Login form submission
    document.getElementById('loginForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      
      try {
        const response = await fetch(`${ApiUrlLink}/login`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ username, password })
        });
        
        const data = await response.json();
        
        if (response.ok) {
          localStorage.setItem('user', JSON.stringify(data.user));
          window.location.href = `dashboard.html?username=${encodeURIComponent(username)}`;
        } else {
          alert(data.error || 'Login failed');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Login failed. Please try again.');
      }
    });
  </script>
</body>
</html>
